# 随机信号实验——RC低通滤波器

[TOC]

## 一、实验目的

1. 了解滤波器的工作原理及特性；

2. 掌握滤波器的设计方法和思路； 

3. 掌握信号源、示波器等仪器的使用方法；

4. 掌握数字示波器的测量各种信号的频谱与基本参数的方法； 

5. 掌握线性系统传递函数的估计方法。



## 二、实验原理

### 2.1 RC低通滤波器

​	典型的无源RC低通滤波器原理图如下图所示：

![](G:\通院大三实验\随机信号实验\image_source\Low_pass_filter.png)

​	RC低通滤波器的工作原理基于电容对信号的频率响应特性。根据电路分析的基础知识可知，电容的阻抗为：
$$
X_{c}=\frac{1}{\omega C}
$$
根据此公式可以得知，当输入信号的频率较低时，电容的阻抗较大，导致通过电容的信号电压降低；而当输入信号的频率较高时，电容的阻抗较小，使得信号电压能够通过电容。因此，RC低通滤波器可以将高频信号通过电容滤除，只保留低频信号，也就是实现了低通滤波的效果，且相对应的截止频率为：
$$
f_{c} =\frac{1}{2\pi RC}
$$
根据电路图，不难得到RC低通滤波器的传输函数为：
$$
H(j \omega )=\frac{u_o}{u_i}=\frac{X_C}{X_C+R}=\frac{\frac1{j \omega C}}{\frac1{j \omega  C}+R}==\frac1{1+j \omega RC}
$$
对此公式做傅里叶逆变换，可以得到该滤波器对应的时域冲激响应：
$$
h(t)=\frac{1}{RC}e^{-\frac{1}{RC}t}
$$

### 2.2 利用MATLAB仿真RC滤波器输入输出信号特性

​	在MATLAB中，我们可以利用函数来模拟截止频率为4kHz的低通RC滤波器，代码如下：

```matlab
%参数设置
Fc = 4e3;            		% 滤波器截止频率 (Hz)，设置为4kHz
R = 1e3; 			 		% 电阻 R = 1kΩ
C = 1 / (2 * pi * Fc * R);  % 电容 C，使得截止频率为 Fc

% 设计无源低通滤波器
num = [1]; % 分子系数
den = [R*C, 1]; % 分母系数 (RCs + 1)
H = tf(num, den); % 创建传递函数

% 生成方波信号
u = square(2*pi*f_square*t_sim);  % 使用square函数生成10kHz的方波信号

% 计算滤波器输出响应
[y, t_out] = lsim(H, u, t_sim);  % 使用lsim函数计算滤波器对输入信号u的响应
```

​	基于此，我们可以输入不同的信号u，得到输出信号y，进而画出输入、输出信号的时域波形、频谱图、自相关函数、功率谱密度等等。



### 2.3 利用高斯白噪声测量线性系统的冲激响应

​	已知白噪声的定义是均值为0，功率谱密度为非零常数的随机信号。

![](G:\通院大三实验\随机信号实验\image_source\gauss.jpg)

而高斯白噪声则是均值为0，且符合正态分布的随机信号，不妨设其功率谱密度为：
$$
P_n(f)=\frac{n_0}{2}\quad(-\infty<f<\infty)
$$
根据维纳-欣钦定理，其自相关函数与功率谱密度互为傅里叶变换对，因此，可以得到其自相关函数：
$$
R(\tau)=\frac{n_0}2\sigma(\tau)
$$
由上两式可知，白噪声的带宽无限，自相关函数为位于$$ \tau =0 $$处的冲激函数。

​	输入白噪声与经过系统后的白噪声() xt的互相关函数为：
$$
R_{nx}(\tau)=\int_{-\infty}^\infty x(\tau) n(t-\tau) d\tau=R_{nx}(-\tau)
$$
白噪声自相关函数$$ R_{nn}(\tau)=\delta(\tau) $$，而
$$
R_{nx}(\tau)=R_{nn}(\tau)*h(-\tau)=h(-\tau) n(t)
$$
所以被测系统输出与输入的白噪声互相关函数为$$a(t)=R_{nx}(-\tau)=h(\tau)$$。原理框图如图：

![](G:\通院大三实验\随机信号实验\image_source\123.jpg)

由于$$ x(t)=n(t)^*h(t)=\sum_\tau h(\tau)n(t\text{-}\tau) $$，故可得：
$$
\begin{aligned}
a(t) & =\frac{1}{N}\sum_{t^{\prime}}x(t^{\prime}) n(t^{\prime}-t) \\
&=\frac1N\sum_{t^{\prime}}\sum_{\tau}h(\tau)n(t^{\prime}-\tau)n(t^{\prime}-t) \\
&=\sum_\tau h(\tau) [\frac1N\sum_{t^{\prime}}n(t^{\prime}-\tau) n(t^{\prime}-t) ] \\
&=\sum_\tau h(\tau)\delta(t-\tau) \\
&=h(\mathrm{t})
\end{aligned}
$$
互相关输出得到的a(t)即为被测系统的时域冲击响应，对其进行傅里叶变换， 即可得到被测系统的频率响应。



### 2.4 搭建截止频率为4kHz低通RC滤波器的参数选择

> 提供的器材与要求如下：
>
> 电阻：4.7kΩ，5.1kΩ
>
> 电容：1000pF
>
> 要求：使用的电子元器件总数小于10个，搭建出截止频率为4kHz的RC低通滤波器。

​	根据上述式子$$f_{c} =\frac{1}{2\pi RC}$$可知，要使得截止频率为$$f_{理想} =4000Hz$$，只需满足$$ \frac{1}{2\pi RC} = 4000 $$即可。鉴于我的截止频率4kHz较小，所以我选择多几个电容，少几个电阻的方案。那么我选择了4.7kΩ，5.1kΩ的电阻各一个，也就是$$R_{实际} = 9.8k\Omega$$ ，根据公式计算可得$$C_{理想} = 4060.08pF$$，由于我们的电容只有1000pF，所以我选择将四个电容并联得到$$C_{实际} = 4000pF$$，进而得到$$f_{实际} =4060.08Hz$$，可知，误差在1.5%，可以接受。电路仿真原理图如下：

![image-20241110160327685](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241110160327685.png)



## 三、实验内容与要求

​	设计一个满足截止频率为4kHz的低通滤波器，用MATLAB仿真不同输入输出信号的时域波形、频谱、自相关函数、功率谱密度等。编写程序利用高斯白噪声测量低通滤波器的冲击响应和频率响应。最后在洞洞板上搭建该滤波器，并用信号源和示波器对滤波器的输入、输出信号的时域波形、频域波形以及滤波器的幅频特性进行测试。

1. RC低通滤波器的设计 
2. RC低通滤波器输入输出信号特性仿真及分析
3. 利用高斯白噪声估计RC低通滤波器的冲击响应
4. RC低通滤波器的实现及性能测试



## 四、实验步骤

​	设计一个满足截止频率为4kHz的低通滤波器，用MATLAB仿真不同输入输出信号的时域波形、频谱、自相关函数、功率谱密度等。编写程序利用高斯白噪声测量低通滤波器的冲击响应和频率响应。最后在洞洞板上搭建该滤波器，并用信号源和示波器对滤波器的输入、输出信号的时域波形、频域波形以及滤波器的幅频特性进行测试。

### 4.1 RC低通滤波器的设计

- 设计一个截止频率为4kHz的RC低通滤波器，给出参数的选取过程。

> 提供的器材与要求如下：
>
> 电阻：4.7kΩ，5.1kΩ
>
> 电容：1000pF
>
> 要求：使用的电子元器件总数小于10个，搭建出截止频率为4kHz的RC低通滤波器。

​	根据上述式子$$f_{c} =\frac{1}{2\pi RC}$$可知，要使得截止频率为$$f_{理想} =4000Hz$$，只需满足$$ \frac{1}{2\pi RC} = 4000 $$即可。鉴于我的截止频率4kHz较小，所以我选择多几个电容，少几个电阻的方案。那么我选择了4.7kΩ，5.1kΩ的电阻各一个，也就是$$R_{实际} = 9.8k\Omega$$ ，根据公式计算可得$$C_{理想} = 4060.08pF$$，由于我们的电容只有1000pF，所以我选择将四个电容并联得到$$C_{实际} = 4000pF$$，进而得到$$f_{实际} =4060.08Hz$$，可知，误差在1.5%，可以接受。

### 4.2 RC低通滤波器输入输出信号特性仿真及分析

- 仿真分析高斯白噪声通过RC低通滤波器后，输入输出信号的均值、方差 、均方值。

​	首先，设置了仿真所需的参数，包括采样频率、采样周期、仿真时间向量及点数。接着，通过定义均值和标准差来生成高斯白噪声信号。滤波器的参数设置为4kHz的截止频率，并利用该截止频率计算滤波器的自然频率。然后，根据传递函数设计一个二阶低通滤波器。利用 `lsim` 函数将生成的白噪声信号输入滤波器，并得到滤波后的输出信号。最后，计算并输出输入信号和输出信号的均值、方差及均方根值，从而能够观察信号通过滤波器后的统计特性变化。

```matlab
clear; clc; close all;
% 参数设置  
Fs = 100e4;           % 采样频率 (Hz)  
T = 1/Fs;             % 采样周期 (s)  
t_sim = 0:T:1;        % 仿真时间向量，从0到1秒  
N = length(t_sim);    % 仿真点数  

% 高斯白噪声参数  
mu = 0;               % 均值  
sigma = 1;            % 标准差  

% 滤波器参数  
Fc = 4e3;             % 截止频率 4kHz  
omega0 = 2*pi*Fc;     % 滤波器自然频率，对应截止频率为4kHz  

% 生成高斯白噪声信号  
u = mu + sigma*randn(1, N);  

% 设计滤波器  
num = [omega0^2];  
den = [1 3*omega0 omega0^2];  
H = tf(num, den);  

% 计算滤波器输出响应  
[y, t_out] = lsim(H, u, t_sim);  

% 计算输入输出信号的统计特性  
mean_u = mean(u);  
mean_y = mean(y);  
var_u = var(u);  
var_y = var(y);  
rms_u = rms(u);  
rms_y = rms(y);  
```

- 仿真分析高斯白噪声通过RC低通滤波器后，输入输出信号自相关函数、 功率谱密度。 

​	为了进一步分析输入和输出信号特性，计算了两者的自相关函数以及功率谱密度，从而揭示滤波前后信号在频域和时域特性的变化。

```matlab
%此部分参数设置代码与上面的相同，不再重复赘述

% 计算滤波器输出响应  
[y, t_out] = lsim(H, u, t_sim);  

% 计算并绘制自相关函数与功率谱密度  
[r_u, lags_u] = xcorr(u, 'coeff', N); % 输入信号的自相关函数  
[r_y, lags_y] = xcorr(y, 'coeff', N); % 输出信号的自相关函数  
Pxx_u = pwelch(u, [], [], [], Fs); % 输入信号的功率谱密度  
Pxx_y = pwelch(y, [], [], [], Fs); % 输出信号的功率谱密度  
```

- 仿真分析不同频率的单音正弦信号通过RC低通滤波器后，输入输出信号幅度的大小，记录并计算RC滤波器的传输系数，绘制出RC滤波器传输函数的幅频特性曲线。 

​	类似上面`lsim`模块实现输入与输出的计算即可。完整例子在下面方波演示。

- 仿真分析频率为10KHz的方波信号输入到设计的滤波器后，输入输出信号的时域波形、频谱、自相关函数、功率谱密度。

​	类似上面`lsim`模块实现输入与输出的计算即可。完整示例如下：

```matlab
% 参数设置
Fs = 100e3;           % 采样频率 (Hz)，设置为100kHz
T = 1/Fs;             % 采样周期 (s)，计算为1/Fs
t_sim = 0:T:0.01;     % 仿真时间向量，从0到0.01秒，步长为采样周期T
f_square = 10e3;      % 方波重复频率 (Hz)，设置为10kHz
Fc = 4e3;            % 滤波器截止频率 (Hz)，设置为4kHz
omega0 = 2*pi*Fc;     % 滤波器自然频率 (rad/s)，转换为弧度/秒
R = 1e3; % 电阻 R = 1kΩ
C = 1 / (2 * pi * Fc * R); % 电容 C，使得截止频率为 Fc

% 生成方波信号
u = square(2*pi*f_square*t_sim);  % 使用square函数生成10kHz的方波信号

% 设计无源低通滤波器
num = [1]; % 分子系数
den = [R*C, 1]; % 分母系数 (RCs + 1)
H = tf(num, den); % 创建传递函数

% 计算滤波器输出响应
[y, t_out] = lsim(H, u, t_sim);  % 使用lsim函数计算滤波器对输入信号u的响应

% 绘制频谱图
NFFT = length(u); % 用于FFT的点数，等于输入信号的长度
f = Fs*(0:(NFFT/2))/NFFT; % 频率向量，用于绘制频谱图
U = fft(u, NFFT); % 输入信号的FFT
Y = fft(y, NFFT); % 输出信号的FFT

% 计算并绘制自相关函数
[r_u, lags_u] = xcorr(u, 'coeff'); % 计算输入信号的自相关函数
[r_y, lags_y] = xcorr(y, 'coeff'); % 计算输出信号的自相关函数

% 计算并绘制功率谱密度
Pxx_u = pwelch(u, [], [], [], Fs); % 计算输入信号的功率谱密度
Pxx_y = pwelch(y, [], [], [], Fs); % 计算输出信号的功率谱密度
```



### 4.3 利用高斯白噪声估计RC低通滤波器的冲击响应

- 根据线性系统冲击响应的估计原理，利用高斯白噪声估计设计的RC滤波器的冲击响应和传输函数的幅频特性(编程实现)，将其与理论结果进行对比分析 。改变部分参数，如采样点数，采样频率，观察估计结果的变化情况。

```matlab
N =10000; % 数据长度， 或者采样点数
fs=2000000; % 采样频率
t=0:1/fs:(N-1)/fs; % 离散的时间序列
fc=5000; % 信号频率
R=9.8e3; % 电阻， 单位欧姆
C=4000e-12; %电容， 单位法拉
sys1=tf(1,[R*C,1]); %模拟一个线性系统
fb1=1/(2*pi*R*C); % 根据 RC 值， 计算得到的低通滤波器截止频率
h1= 1/(R*C)*exp(-1/(R*C).*t)/fs; % RC 低通滤波器对应的时域冲击响应理论值
ff=0:fs/N:fs/2-fs/N; 
H=1./(1+1i*2*pi*ff*R*C); % RC 低通滤波器传输函数的理论值
mu = 0; sigma = 1;
noise=mu+sqrt(sigma)*randn(1,N);% 产生均值为mu=0,方差sigma=1的高斯白噪声
xt1= lsim(sys1, noise, t); % 将高斯白噪声信号noise送入到系统sys1中， t是时间序列， y是输出信号
yt1=xcorr(xt1,noise)/N; % 过被测系统后的输出信号xt1与高斯白噪声求互相关,除以N是为了归一化
L1=length(yt1);
h1_est=yt1(floor((L1)/2)+1:L1); % 取后半部分数值， 即为估计到的系统冲击响应，
figure();
plot(t(2:200),h1(2:200),"v-",color="blue"); % 画出滤波器冲击响应,从第二个采样值开始
hold("on");
plot(t(2:200),h1_est(2:200),".-",color="red");
title("低通滤波器时域冲激响应");xlabel("时间/s");ylabel("幅度/V");
legend("真实的冲激响应","估计的冲激响应")
M=390; % M 取值不能太大， 太大， 会影响估计结果
fft_h1_est=fft(h1_est(1:M),N); %对h1_est的前M个点进行傅里叶变换， 因为低通滤波器后面的数值接近与0，
f=0:fs/N:fs/2-fs/N;
figure();semilogx(f,abs(H),"-");hold("on"); %系统传输函数的幅频特性（ 理论分析结果）
semilogx(f,(abs(fft_h1_est(1:length(f))))),"-"; % 系统传输传输（ 估计结果）
xlabel("频率/Hz");ylabel("传输系数"); title("滤波器传输函数");
legend("真实传输函数","估计到的传输函数")
```



### 4.4 RC低通滤波器的实现及性能测试

- 在洞洞板上搭建一个真实的RC滤波器，利用信号源、示波器观测输入输出信号的时域波形和频谱图（输入信号为单音正弦信号），拍照记录（选取3-5个频率点的结果拍照记录即可）。
- 测量不同频率下输入输出信号的幅度，记录下来，计算不同频率下滤波器的传输参数，绘制滤波器实际测量得到的幅频特性，将其与理论计算结果以及第3步的估计结果进行对比。如果有偏差，计算偏差的大小，并分析可能的原因；
- 观测输入信号为方波或其它信号（如三角波或者已调信号）送入到低通滤波器后的输出信号波形和频谱，并对结果进行分析解释。



## 五、实验结果分析及结论

### 5.1 高斯白噪声通过RC低通滤波器的输入输出特性

#### 5.1.1 仿真分析高斯白噪声经过RC低通滤波器的输入输出信号的均值、方差、均方值

​	高斯白噪声是一种统计特性为均值为零、方差恒定的随机信号，其幅度在时域上服从高斯分布。它的功率谱密度在所有频率上均匀分布，因此被称为“白噪声”。高斯白噪声的均值为零，表示其信号波动围绕零值对称分布。方差决定了噪声的幅度分布范围，通常表示为 $$\sigma^2$$，而均方根值等于其标准差 $$\sigma$$，即噪声的幅度波动程度。**因此，高斯白噪声的均值为0，方差为 $$\sigma^2$$，均方根值为 $$\sigma$$。**

​	当高斯白噪声通过一个截止频率为4kHz的RC低通滤波器时，**噪声的均值仍然保持为零**，因为滤波器不会改变信号的均值。然而，方差会发生变化，滤波器会衰减超过4kHz的频率成分，从而降低噪声的总功率。最终，**滤波后噪声的方差将减小，均方根值也会相应减小**，但它仍然是噪声的标准差。
​	在设计的程序中，我**将高斯白噪声的均值设置为0，方差设置为1**。经过MATLAB仿真后得到的计算结果，如下表所示：

|          | 高斯白噪声 | 高斯白噪声经过RC低通滤波器 |
| :------: | :--------: | :------------------------: |
|   均值   |  0.001138  |          0.001136          |
|   方差   |  0.999812  |          0.004101          |
| 均方根值 |  0.999906  |          0.064051          |

​	显然，实验结果符合上述分析，实验合理。

#### 5.1.2 仿真分析高斯白噪声经过RC低通滤波器的输入输出信号的自相关函数与功率谱密度

（1）输入信号的自相关函数与功率谱密度

- 高斯白噪声的自相关函数应该为：

$$
R_x(\tau)=\sigma^2\delta(\tau)
$$

​	其中，$$\sigma^2$$ 是噪声的方差。

![image-20241113160750351](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241113160750351.png)

​	从图像上可以看出，自相关函数在零时取值最大，在其他部分取值为零，符合上述分析。



- 高斯白噪声的功率谱密度应该为：

$$
S_x(f)=\sigma^2
$$

​	其中，$$\sigma^2$$ 是噪声的方差。

![image-20241113160723553](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241113160723553.png)

​	从图像上可以看出，在宽谱的范围内，功率谱密度都维持在一定的常数间，符合上述分析。



（2）输出信号的自相关函数与功率谱密度

- 输出信号的自相关函数

​	由于低通滤波器是线性系统，输出信号的自相关函数与输入信号的自相关函数相乘，并且受滤波器的影响。滤波后的自相关函数是输入自相关函数与滤波器的冲激响应卷积的结果。因为RC低通滤波器的频率响应为：
$$
H(f)=\frac1{1+j2\pi f\tau}
$$
其中，$$\tau = RC$$是RC低通滤波器的时间常数。所以，**输出信号的自相关函数会变宽，且包含更少高频成分。**

![image-20241113160939033](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241113160939033.png)

从图像可以看出，输出信号的自相关函数在非零部分不全为零，自相关函数变宽，符合上述分析。



- 输出信号的功率谱密度

​	低通滤波器的功率谱密度可以通过对输入信号的功率谱密度乘以滤波器的频率响应的平方来获得。假设滤波器的截止频率为4kHz，则输出信号的功率谱密度为：
$$
S_y(f)=S_x(f)\cdot|H(f)|^2
$$
由于滤波器在4kHz以下通过信号，而在4kHz以上衰减，因此输出信号的功率谱密度在4kHz以上会有明显衰减。具体地，**输出信号的功率谱密度在4kHz以下保持较为平坦，而在4kHz以上将快速下降。**

![image-20241113160954541](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241113160954541.png)

从图像是可以看出，在接近0的部分功率谱密度衰减极小，而越到高频部分，功率谱密度衰减越剧烈，符合上述分析。



### 5.2 不同频率的单音正弦信号通过RC低通滤波器的输入输出特性

#### 5.2.1 不同频率的单音正弦信号通过RC低通滤波器后输入输出信号的幅度大小

​	当不同频率的单音正弦信号通过截止频率为4kHz的RC低通滤波器时，信号的幅度变化呈现以下趋势：低于4kHz的信号几乎没有幅度衰减，输出幅度与输入幅度基本相同。随着频率接近4kHz，信号的幅度开始逐渐衰减。对于高于4kHz的信号，衰减变得更为显著，频率越高，输出幅度衰减越多。

| 正弦信号频率 (Hz) | 输入信号幅度 | 输出信号幅度 |
| :---------------: | :----------: | :----------: |
|        100        |    0.7071    |    0.7069    |
|        500        |    0.7071    |    0.7016    |
|       1000        |    0.7071    |    0.6858    |
|       2000        |    0.7071    |    0.6316    |
|       4000        |    0.7071    |    0.4974    |
|       8000        |    0.7071    |    0.3096    |
|       10000       |    0.7071    |    0.2539    |

​	显然，根据数据我们可以看出低于4kHz的信号幅度衰减较小。随着频率接近4kHz，信号的幅度开始逐渐衰减。对于高于4kHz的信号，衰减变得更为显著，频率越高，输出幅度衰减越多，符合上述分析。

#### 5.2.2 不同频率的单音正弦信号通过RC低通滤波器后的传输系数

​	当不同频率的单音正弦信号通过截止频率为4kHz的RC低通滤波器时，传输系数（即幅度响应）会随频率变化。RC低通滤波器的幅频响应可以通过以下公式计算：
$$
|H(f)|=\frac1{\sqrt{1+(f/f_c)^2}}
$$
其中，$$f_c$$是滤波器的截止频率（4kHz），$$f$$是输入信号的频率。随着频率增加，尤其是超过4kHz后，传输系数逐渐减小。截止频率4kHz处的传输系数为约0.707，表示信号幅度衰减了3 dB。高于4kHz的信号幅度衰减更显著，频率越高，衰减越强。

| 正弦信号频率 (Hz) | 传输系数 |
| :---------------: | :------: |
|        100        |  0.9997  |
|        500        |  0.9922  |
|       1000        |  0.9698  |
|       2000        |  0.8933  |
|       4000        |  0.7034  |
|       8000        |  0.4378  |
|       10000       |  0.3591  |

​	显然，根据实验数据可知，随着频率增加传输系数逐渐减小。高于4kHz的信号幅度衰减更显著，频率越高，衰减越强，符合上述分析。

#### 5.2.3 RC低通滤波器的幅频曲线

​	截止频率为4kHz的RC低通滤波器的幅频特性曲线表现为：在4kHz以下，信号几乎没有衰减，幅度接近1，曲线几乎是水平的。当频率达到4kHz时，幅度下降到原来的约70.7%（-3 dB）。在4kHz以上，幅度开始迅速衰减，随着频率的增加，衰减加剧，直到接近零。整体上，幅频响应呈现一个平坦的低频部分和一个快速下降的高频部分。

![image-20241113162808837](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241113162808837.png)

​	根据图像分析可知：在4kHz以下，信号几乎没有衰减，幅度接近1，曲线几乎是水平的。在4kHz以上，幅度开始迅速衰减，随着频率的增加，衰减加剧，直到接近零，符合上述分析。



### 5.3 频率为10KHz的方波信号通过RC低通滤波器的输入输出特性

#### 5.3.1 频率为10kHz的方波信号通过RC低通滤波器输入输出信号的时域波形

- 输入信号

​	10kHz的方波具有快速的上升和下降边缘，周期为100μs，且信号幅度在±1之间跳变。

- 输出信号

​	由于RC低通滤波器的截止频率为4kHz，滤波器会滤除高于4kHz的频率成分。10kHz的方波包含许多高频谐波成分，而这些高频成分会被滤波器衰减，因此输出信号的波形会变得更加平滑，边缘不再那么陡峭。它会变成一个近似于低频的“锯齿波”或“阶梯波”，频率较低，波形的上升和下降过程会显著变缓。

![](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241119194602340.png)

​	根据图像可以看出，10kHz方波经过RC低通滤波器变成一个近似低频的锯齿波，与上文分析一致。

#### 5.3.2 频率为10kHz的方波信号通过RC低通滤波器输入输出信号的频域波形

- 输入信号

​	10kHz的方波可以分解成一个基频为10kHz的正弦波和许多高频谐波，故频谱中有大量的高频成分。

- 输出信号

​	RC低通滤波器会削弱高于4kHz的频率成分，因此在输出信号的频谱中，10kHz及其更高频率的谐波会大幅衰减，剩下的频谱成分主要集中在4kHz以下，表现为低频成分的增强，高频部分的显著衰减。

![image-20241117105806495](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241117105806495.png)

​	根据图像可知，4kHz以下的频谱成分出现较小的衰减，而大于4kHz的频谱成分则显著衰减，与上文分析一致。

#### 5.3.3 频率为10kHz的方波信号通过RC低通滤波器输入输出信号的自相关函数

- 输入信号

​	由于方波信号是周期性的，其自相关函数会呈现周期性的形态，周期等于方波的周期。自相关函数会有多个峰值，每个峰值对应一个周期。

- 输出信号

​	滤波后的信号变得更加平滑，边缘没有那么锐利，因此输出信号的自相关函数会变得更加宽，周期性特征依然存在，但会比输入信号更加平滑且延迟更长。

![image-20241117105933027](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241117105933027.png)

​	根据图像可知，输出信号较为平滑，实验结果符合上述分析。

#### 5.3.4 频率为10kHz的方波信号通过RC低通滤波器输入输出信号的功率谱密度

- 输入信号

​	输入的10kHz方波的功率谱密度会有一个主峰位于10kHz，并且有较强的高频谐波成分，功率分布在较高的频率范围。

- 输出信号

​	通过低通滤波器后，输出信号的功率谱密度会显著减小高于4kHz的频率成分，功率集中在4kHz以下。频谱上，4kHz以上的部分会迅速下降，功率主要集中在4kHz以下的低频区域。

![image-20241117110034901](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241117110034901.png)

显然，观察左侧纵坐标的值，可以发现，4kHz以上的部分迅速衰减，符合上述分析，实验合理。



### 5.4 利用高斯白噪声估计RC低通滤波器的冲激响应

#### 5.4.1 改变采样点数、采样频率对滤波器传输函数的影响

- 增加采样点数

​	频率分辨率提高（频率间隔为 $$\Delta f = \frac{fs}{N}$$），估计的传输函数曲线更平滑且分辨率更高。

- 增加采样频率

​	最大分析频率范围（奈奎斯特频率 $$\frac{fs}{2}$$）扩大，能够展示更高频率范围的传输特性,且拟合精度更好。

![image-20241117111930496](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241117111930496.png)

​	从实验结果来看，增加采样点数对滤波器传输函数的估计提升性能良好，符合分析。但增加采样频率对滤波器传输函数的估计提升不明显，我认为可能的原因是：

1. 频率分辨率的影响

​	增加采样频率 $$fs$$ 时，奈奎斯特频率（$$\frac{fs}{2}$$）变高，但频率分辨率（$$\Delta f = \frac{fs}{N}$$）未变，因为采样点数$$N$$ 未增加。因此，频域特性曲线的分辨率提升有限，对估计结果的精度影响不大。

2. 系统特性的限制

​	RC 低通滤波器本身的截止频率远低于原采样频率，即使提高 $$fs$$，高频部分信号本来已被大幅衰减。

#### 5.4.2 改变采样点数、采样频率对滤波器冲激响应的影响

- 增加采样点数

​	时间序列 $$t$$会覆盖更长的时间范围，冲激响应的采样点变多，曲线更加细腻。互相关函数的计算会更精确，估计得到的冲激响应更接近理论值。

- 增加采样频率

​	时间序列的采样间隔变小（$$\Delta t = \frac{1}{fs}$$），时域冲激响应曲线更加细腻，能够捕捉到快速变化的细节。理论冲激响应和估计值的吻合度提高。

![image-20241117111808773](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241117111808773.png)

​	根据图像结果可知，提升采样点和采样频率，都可以提高估计精度，符合上述分析。



### 5.5 RC低通滤波器的实现及性能测试

#### 5.5.1 测量实际单音正弦信号通过真实RC滤波器的输入输出信号的时域波形和频谱图

​	当不同频率的单音正弦信号通过截止频率为4kHz的RC低通滤波器时，信号的幅度变化呈现以下趋势：低于4kHz的信号几乎没有幅度衰减，输出幅度与输入幅度基本相同。随着频率接近4kHz，信号的幅度开始逐渐衰减。对于高于4kHz的信号，衰减变得更为显著，频率越高，输出幅度衰减越多。频域波形则表现为低于4kHz的信号幅值基本保持，接近4kHz的信号开始衰减，而高于4kHz的频率分量幅值开始下降，最终接近零。

​	![image-20241117141656686](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241117141656686.png)

​	在这里，我们取特殊频率4kHz进行分析。根据截止频率的定义，4kHz正弦信号幅度将倍RC低通滤波器衰减为-3dB，也就是转化为数值接近$$\frac{1}{\sqrt{2}}$$。我们这里设置的信号源电压幅度均为5V，根据计算可得：
$$
U_{理论}=5V\times \frac{1}{\sqrt{2} } =3.52V
$$
​	可以看到，与实验结果一致。其他频率得趋势与上文分析也保持一致，故实验结果正确。

### 5.5.2 测量、计算实际RC滤波器的传输函数并绘制幅频特性曲线

​	根据测量，我们得到如下数据：

| 正弦信号的频率 | 正弦信号的幅度 |
| -------------- | -------------- |
| khz            | V              |
| 0.1            | 5              |
| 0.5            | 4.92           |
| 1              | 4.8            |
| 1.3            | 4.72           |
| 1.5            | 4.64           |
| 1.7            | 4.6            |
| 2              | 4.44           |
| 2.3            | 4.32           |
| 2.5            | 4.2            |
| 2.7            | 4.12           |
| 3              | 4              |
| 3.2            | 3.92           |
| 3.4            | 3.78           |
| 3.6            | 3.68           |
| 3.8            | 3.6            |
| 4              | 3.53           |
| 4.2            | 3.44           |
| 5              | 3.14           |
| 7              | 2.5            |
| 10             | 1.92           |
| 20             | 1.02           |
| 30             | 0.684          |
| 50             | 0.424          |
| 100            | 0.214          |

​	我们以上述数据为依据，画出了如下的幅频特性曲线：

![image-20241117143308072](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241117143308072.png)

并且我们得到了传输系数实际值的对应表格：

| 正弦信号频率 (Hz) | 传输系数 |
| ----------------- | -------- |
| 100               | 1.0000   |
| 500               | 0.9840   |
| 1000              | 0.9600   |
| 2000              | 0.8880   |
| 4000              | 0.7060   |
| 8000              | 0.4540   |
| 10000             | 0.3840   |

而我们在上文分析得到的传输系数理论值对应表格为：

| 正弦信号频率 (Hz) | 传输系数 |
| ----------------- | -------- |
| 100               | 0.9997   |
| 500               | 0.9922   |
| 1000              | 0.9698   |
| 2000              | 0.8933   |
| 4000              | 0.7034   |
| 8000              | 0.4378   |
| 10000             | 0.3591   |

​	不难看出，仅存在微小误差，且误差处于合理范围，实验准确。

#### 5.5.3测量方波信号、三角波信号通过真实RC滤波器的输入输出信号的时域波形和频谱图

- 方波信号

​	当方波信号通过截止频率为4kHz的RC低通滤波器后，由于方波信号含有丰富的高频谐波成分，滤波器将这些高频成分衰减，从而导致时域波形逐渐变得平滑。原本具有明显跃变的方波，将呈现出一个更为平缓的波形，类似于一个渐变的阶梯形状。随着频率逐渐降低，波形的锐利特征被消除，变得更接近于低频信号的形态。在频域上，方波的频谱包含多个高次谐波，这些高频成分会被滤波器抑制，频谱的带宽会显著变窄，主要集中在低频区。

![image-20241117144644068](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241117144644068.png)

​	显然，实验结果在低频接近梯形波，在高频接近锯齿波，实验与上文分析一致。

- 三角波信号

​	三角波信号在经过同样的RC低通滤波器后，其时域波形也会变得更为平滑。三角波的波形特征是具有一定坡度的线性变化，经过滤波后，尖锐的转折部分会被平滑掉，波形变得更加圆滑，趋向于一个类似正弦波的平滑曲线。由于三角波本身的频谱较方波较为简单，滤波器的影响相对较小，但仍然会在高频部分产生衰减，使得高频成分减少，波形中的细节被抑制。在频域上，三角波信号的频谱呈现出周期性的衰减，经过滤波后，频谱会向低频区域集中，带宽明显变窄。

![image-20241117144940350](C:\Users\DcStark\AppData\Roaming\Typora\typora-user-images\image-20241117144940350.png)

​	显然，随着频率的提升越来越近正弦曲线，与上文分析一致。



## 六、心得体会

在本次实验中，我通过解决实际问题和优化实验设计，对RC低通滤波器的构建和系统响应仿真的理解有了进一步提升，主要体会如下：

1. **RC低通滤波器设计的误差控制**
   在实际搭建RC低通滤波器时，我发现截止频率与理论值存在较大误差。经过分析，问题主要出在电容元件的误差较大。为了解决这一问题，我重新设计了电路，利用电容并联的特性，通过多组电容组合减小了误差的影响。这不仅提升了滤波器的性能，也让我深刻体会到元件参数对电路设计精度的重要性以及如何通过巧妙的电路设计来弥补元件缺陷。
2. **冲激响应仿真中的参数调整**
   在利用高斯白噪声测量线性系统的冲激响应的MATLAB仿真中，起初我发现当频率改为4kHz时，生成的图像总是不正确。经过深入分析，我发现问题出在对例程参数的调整上，尤其是M值的设置。由于低通滤波器后面部分的数据接近零，正确选择一个合适的M值，确保对 `h1_est` 的前M个点进行傅里叶变换，才能生成合理的频谱图像。通过这一问题，我加深了对冲激响应测量方法及其关键参数的理解，学会了如何根据实际滤波器特性调整仿真参数以获得正确结果。
